import{r as P,g as X,a as tt,u as rt,b as C,c as ct,s as j,j as o,d as g,e as et,m as dt,f as pt,T as c,t as K,h as ot,i as E,k as L,l as gt,C as G,B as O,n as ut,o as J,p as ht}from"./index-BzEnDVyk.js";const nt=e=>{const t=P.useRef({});return P.useEffect(()=>{t.current=e}),t.current};function ft(e){const{badgeContent:t,invisible:n=!1,max:a=99,showZero:d=!1}=e,l=nt({badgeContent:t,max:a});let p=n;n===!1&&t===0&&!d&&(p=!0);const{badgeContent:s,max:r=a}=p?l:e,i=s&&Number(s)>r?`${r}+`:s;return{badgeContent:s,invisible:p,max:r,displayValue:i}}function mt(e){return tt("MuiBadge",e)}const y=X("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),V=10,Y=4,vt=e=>{const{color:t,anchorOrigin:n,invisible:a,overlap:d,variant:l,classes:p={}}=e,s={root:["root"],badge:["badge",l,a&&"invisible",`anchorOrigin${g(n.vertical)}${g(n.horizontal)}`,`anchorOrigin${g(n.vertical)}${g(n.horizontal)}${g(d)}`,`overlap${g(d)}`,t!=="default"&&`color${g(t)}`]};return et(s,mt,p)},xt=j("span",{name:"MuiBadge",slot:"Root"})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),bt=j("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${g(n.anchorOrigin.vertical)}${g(n.anchorOrigin.horizontal)}${g(n.overlap)}`],n.color!=="default"&&t[`color${g(n.color)}`],n.invisible&&t.invisible]}})(dt(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:V*2,lineHeight:1,padding:"0 6px",height:V*2,borderRadius:V,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(pt(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText}})),{props:{variant:"dot"},style:{borderRadius:Y,height:Y*2,minWidth:Y*2,padding:0}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function Q(e){return{vertical:e?.vertical??"top",horizontal:e?.horizontal??"right"}}const yt=P.forwardRef(function(t,n){const a=rt({props:t,name:"MuiBadge"}),{anchorOrigin:d,className:l,classes:p,component:s,components:r={},componentsProps:i={},children:m,overlap:v="rectangular",color:S="default",invisible:A=!1,max:B=99,badgeContent:u,slots:h,slotProps:f,showZero:x=!1,variant:R="standard",...M}=a,{badgeContent:b,invisible:k,max:w,displayValue:H}=ft({max:B,invisible:A,badgeContent:u,showZero:x}),I=nt({anchorOrigin:Q(d),color:S,overlap:v,variant:R,badgeContent:u}),T=k||b==null&&R!=="dot",{color:U=S,overlap:N=v,anchorOrigin:W,variant:$=R}=T?I:a,F=Q(W),_=$!=="dot"?H:void 0,D={...a,badgeContent:b,invisible:T,max:w,displayValue:_,showZero:x,anchorOrigin:F,color:U,overlap:N,variant:$},Z=vt(D),q={slots:{root:h?.root??r.Root,badge:h?.badge??r.Badge},slotProps:{root:f?.root??i.root,badge:f?.badge??i.badge}},[at,it]=C("root",{elementType:xt,externalForwardedProps:{...q,...M},ownerState:D,className:ct(Z.root,l),ref:n,additionalProps:{as:s}}),[st,lt]=C("badge",{elementType:bt,externalForwardedProps:q,ownerState:D,className:Z.badge});return o.jsxs(at,{...it,children:[m,o.jsx(st,{...lt,children:_})]})});function Ct(e){return tt("MuiCardHeader",e)}const z=X("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Ot=e=>{const{classes:t}=e;return et({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Ct,t)},Pt=j("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>[{[`& .${z.title}`]:t.title},{[`& .${z.subheader}`]:t.subheader},t.root]})({display:"flex",alignItems:"center",padding:16}),jt=j("div",{name:"MuiCardHeader",slot:"Avatar"})({display:"flex",flex:"0 0 auto",marginRight:16}),Rt=j("div",{name:"MuiCardHeader",slot:"Action"})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),St=j("div",{name:"MuiCardHeader",slot:"Content"})({flex:"1 1 auto",[`.${K.root}:where(& .${z.title})`]:{display:"block"},[`.${K.root}:where(& .${z.subheader})`]:{display:"block"}}),Tt=P.forwardRef(function(t,n){const a=rt({props:t,name:"MuiCardHeader"}),{action:d,avatar:l,component:p="div",disableTypography:s=!1,subheader:r,subheaderTypographyProps:i,title:m,titleTypographyProps:v,slots:S={},slotProps:A={},...B}=a,u={...a,component:p,disableTypography:s},h=Ot(u),f={slots:S,slotProps:{title:v,subheader:i,...A}};let x=m;const[R,M]=C("title",{className:h.title,elementType:c,externalForwardedProps:f,ownerState:u,additionalProps:{variant:l?"body2":"h5",component:"span"}});x!=null&&x.type!==c&&!s&&(x=o.jsx(R,{...M,children:x}));let b=r;const[k,w]=C("subheader",{className:h.subheader,elementType:c,externalForwardedProps:f,ownerState:u,additionalProps:{variant:l?"body2":"body1",color:"textSecondary",component:"span"}});b!=null&&b.type!==c&&!s&&(b=o.jsx(k,{...w,children:b}));const[H,I]=C("root",{ref:n,className:h.root,elementType:Pt,externalForwardedProps:{...f,...B,component:p},ownerState:u}),[T,U]=C("avatar",{className:h.avatar,elementType:jt,externalForwardedProps:f,ownerState:u}),[N,W]=C("content",{className:h.content,elementType:St,externalForwardedProps:f,ownerState:u}),[$,F]=C("action",{className:h.action,elementType:Rt,externalForwardedProps:f,ownerState:u});return o.jsxs(H,{...I,children:[l&&o.jsx(T,{...U,children:l}),o.jsxs(N,{...W,children:[x,b]}),d&&o.jsx($,{...F,children:d})]})}),$t=ot([o.jsx("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22z"},"0"),o.jsx("path",{d:"M13 16h-2v2h2zm0-6h-2v5h2z"},"1")]),zt=ot([o.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),o.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]);function Bt({patientId:e}){const t="patient-example-female",[n,a]=P.useState([]);P.useEffect(()=>{if(e===t){a([E,L]);return}gt.oauth2.ready().then(r=>{console.log("Fetching allergies for patient:",e),console.log("Using client:",r),r.request("AllergyIntolerance?patient=Patient/"+e).then(i=>{console.log("Received bundle:",i);const m=i.entry?.map(v=>v.resource)||[];a(m.length>0?m:[])}).catch(()=>{console.log("Failed to fetch allergies for patient:",e),a([E,L])})}).catch(()=>{console.log("No SMART context, using mock data",e),a([E,L])})},[e]);function d(r){switch(r.toLowerCase()){case"active":return"error";case"inactive":return"warning";case"resolved":return"success";default:return"default"}}function l(r){switch(r){case"confirmed":return"primary";case"unconfirmed":return"secondary";case"refuted":return"warning";case"entered-in-error":return"error";default:return"default"}}function p(r){switch(r){case"severe":return"error.main";case"moderate":return"warning.main";case"mild":return"info.main";default:return"text.secondary"}}function s(r){return r?r.extension&&Array.isArray(r.extension)&&r.extension.some(i=>i.url==="http://hl7.org/fhir/StructureDefinition/data-absent-reason"&&i.valueCode==="unknown")?"Unknown":r?ht(r):null:null}return o.jsxs(G,{children:[o.jsx(Tt,{sx:{mb:0,pb:0},title:o.jsxs(O,{display:"flex",alignItems:"center",gap:1,children:[o.jsx($t,{color:"error",fontSize:"medium"}),o.jsx(c,{variant:"h6",fontWeight:600,children:"Allergies & Intolerances"}),o.jsx(yt,{badgeContent:n.length,color:"primary",sx:{ml:2}})]})}),o.jsx(ut,{children:n.length===0?o.jsx(c,{align:"center",color:"text.secondary",sx:{py:4},children:"No information recorded (including no known allergies)."}):n.map(r=>o.jsxs(G,{variant:"outlined",sx:{mb:1,p:2,backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:[o.jsx(O,{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",children:o.jsxs(O,{children:[o.jsxs(O,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",mb:.5,children:[o.jsx(c,{variant:"subtitle1",fontWeight:500,children:r.code?.text||r.code?.coding?.[0].display||`${r.code?.coding?.[0].code} ${r.code?.coding?.[0].system}`||"Unknown Allergy"}),o.jsx(J,{label:r.clinicalStatus?.text||r.clinicalStatus?.coding?.[0]?.code||"Unknown",color:d(r.clinicalStatus?.text||r.clinicalStatus?.coding?.[0]?.code||"Unknown"),variant:"outlined",sx:{textTransform:"capitalize",fontWeight:600}}),o.jsx(J,{label:r.verificationStatus?.text||r.verificationStatus?.coding?.[0]?.code||"Unknown",color:l(r.verificationStatus?.text||r.verificationStatus?.coding?.[0]?.code||"Unknown"),variant:"outlined",sx:{textTransform:"capitalize",fontWeight:600}})]}),o.jsx(c,{variant:"body2",color:"text.secondary",children:`type: ${r.type||"unknown"} - category: ${r.category?.join(", ")||"unknown"}`}),o.jsxs(O,{display:"flex",alignItems:"center",gap:1,mt:1,children:[o.jsx(zt,{fontSize:"small"}),o.jsxs(c,{variant:"body2",color:"text.secondary",children:["Onset:"," ",s(r.onsetDateTime)||"Not recorded"]})]})]})}),r.reaction&&r.reaction.length>0&&o.jsxs(O,{mt:1,children:[o.jsx(c,{variant:"body2",fontWeight:500,color:"text.secondary",children:"Reactions:"}),r.reaction.map((i,m)=>o.jsxs(O,{display:"flex",alignItems:"center",gap:1,ml:2,children:[o.jsxs(c,{variant:"body2",fontWeight:600,sx:{color:p(i.severity||"Unknown"),textTransform:"capitalize"},children:[i.severity,":"]}),o.jsx(c,{variant:"body2",children:i.manifestation.map(v=>v.text).join(", ")})]},m))]})]},r.id))})]})}export{Bt as default};
