import{r as O,g as X,a as rr,u as tr,b as x,c as cr,s as P,j as o,d as g,e as er,m as dr,f as pr,T as l,t as G,h as or,i as gr,k as E,l as L,C as J,B as C,n as ur,o as K,p as hr}from"./index-De6OEAgB.js";const nr=e=>{const r=O.useRef({});return O.useEffect(()=>{r.current=e}),r.current};function fr(e){const{badgeContent:r,invisible:n=!1,max:i=99,showZero:c=!1}=e,s=nr({badgeContent:r,max:i});let d=n;n===!1&&r===0&&!c&&(d=!0);const{badgeContent:t,max:a=i}=d?s:e,p=t&&Number(t)>a?`${a}+`:t;return{badgeContent:t,invisible:d,max:a,displayValue:p}}function mr(e){return rr("MuiBadge",e)}const b=X("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),V=10,Y=4,vr=e=>{const{color:r,anchorOrigin:n,invisible:i,overlap:c,variant:s,classes:d={}}=e,t={root:["root"],badge:["badge",s,i&&"invisible",`anchorOrigin${g(n.vertical)}${g(n.horizontal)}`,`anchorOrigin${g(n.vertical)}${g(n.horizontal)}${g(c)}`,`overlap${g(c)}`,r!=="default"&&`color${g(r)}`]};return er(t,mr,d)},br=P("span",{name:"MuiBadge",slot:"Root"})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),xr=P("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,r)=>{const{ownerState:n}=e;return[r.badge,r[n.variant],r[`anchorOrigin${g(n.anchorOrigin.vertical)}${g(n.anchorOrigin.horizontal)}${g(n.overlap)}`],n.color!=="default"&&r[`color${g(n.color)}`],n.invisible&&r.invisible]}})(dr(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:V*2,lineHeight:1,padding:"0 6px",height:V*2,borderRadius:V,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(pr(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main,color:(e.vars||e).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:Y,height:Y*2,minWidth:Y*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${b.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${b.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${b.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${b.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${b.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${b.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${b.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${b.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function Q(e){return{vertical:e?.vertical??"top",horizontal:e?.horizontal??"right"}}const yr=O.forwardRef(function(r,n){const i=tr({props:r,name:"MuiBadge"}),{anchorOrigin:c,className:s,classes:d,component:t,components:a={},componentsProps:p={},children:y,overlap:R="rectangular",color:S="default",invisible:B=!1,max:A=99,badgeContent:u,slots:h,slotProps:f,showZero:m=!1,variant:j="standard",...M}=i,{badgeContent:v,invisible:k,max:w,displayValue:H}=fr({max:A,invisible:B,badgeContent:u,showZero:m}),I=nr({anchorOrigin:Q(c),color:S,overlap:R,variant:j,badgeContent:u}),$=k||v==null&&j!=="dot",{color:U=S,overlap:W=R,anchorOrigin:N,variant:T=j}=$?I:i,F=Q(N),Z=T!=="dot"?H:void 0,D={...i,badgeContent:v,invisible:$,max:w,displayValue:Z,showZero:m,anchorOrigin:F,color:U,overlap:W,variant:T},_=vr(D),q={slots:{root:h?.root??a.Root,badge:h?.badge??a.Badge},slotProps:{root:f?.root??p.root,badge:f?.badge??p.badge}},[ar,ir]=x("root",{elementType:br,externalForwardedProps:{...q,...M},ownerState:D,className:cr(_.root,s),ref:n,additionalProps:{as:t}}),[sr,lr]=x("badge",{elementType:xr,externalForwardedProps:q,ownerState:D,className:_.badge});return o.jsxs(ar,{...ir,children:[y,o.jsx(sr,{...lr,children:Z})]})});function Cr(e){return rr("MuiCardHeader",e)}const z=X("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Or=e=>{const{classes:r}=e;return er({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Cr,r)},Pr=P("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,r)=>[{[`& .${z.title}`]:r.title},{[`& .${z.subheader}`]:r.subheader},r.root]})({display:"flex",alignItems:"center",padding:16}),jr=P("div",{name:"MuiCardHeader",slot:"Avatar"})({display:"flex",flex:"0 0 auto",marginRight:16}),Rr=P("div",{name:"MuiCardHeader",slot:"Action"})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Sr=P("div",{name:"MuiCardHeader",slot:"Content"})({flex:"1 1 auto",[`.${G.root}:where(& .${z.title})`]:{display:"block"},[`.${G.root}:where(& .${z.subheader})`]:{display:"block"}}),$r=O.forwardRef(function(r,n){const i=tr({props:r,name:"MuiCardHeader"}),{action:c,avatar:s,component:d="div",disableTypography:t=!1,subheader:a,subheaderTypographyProps:p,title:y,titleTypographyProps:R,slots:S={},slotProps:B={},...A}=i,u={...i,component:d,disableTypography:t},h=Or(u),f={slots:S,slotProps:{title:R,subheader:p,...B}};let m=y;const[j,M]=x("title",{className:h.title,elementType:l,externalForwardedProps:f,ownerState:u,additionalProps:{variant:s?"body2":"h5",component:"span"}});m!=null&&m.type!==l&&!t&&(m=o.jsx(j,{...M,children:m}));let v=a;const[k,w]=x("subheader",{className:h.subheader,elementType:l,externalForwardedProps:f,ownerState:u,additionalProps:{variant:s?"body2":"body1",color:"textSecondary",component:"span"}});v!=null&&v.type!==l&&!t&&(v=o.jsx(k,{...w,children:v}));const[H,I]=x("root",{ref:n,className:h.root,elementType:Pr,externalForwardedProps:{...f,...A,component:d},ownerState:u}),[$,U]=x("avatar",{className:h.avatar,elementType:jr,externalForwardedProps:f,ownerState:u}),[W,N]=x("content",{className:h.content,elementType:Sr,externalForwardedProps:f,ownerState:u}),[T,F]=x("action",{className:h.action,elementType:Rr,externalForwardedProps:f,ownerState:u});return o.jsxs(H,{...I,children:[s&&o.jsx($,{...U,children:s}),o.jsxs(W,{...N,children:[m,v]}),c&&o.jsx(T,{...F,children:c})]})}),Tr=or([o.jsx("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22z"},"0"),o.jsx("path",{d:"M13 16h-2v2h2zm0-6h-2v5h2z"},"1")]),zr=or([o.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),o.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]);function Ar({patientId:e}){const[r,n]=O.useState([]);O.useEffect(()=>{gr.oauth2.ready().then(t=>{if(!e){n([E,L]);return}console.log("Fetching allergies for patient:",e),console.log("Using client:",t),t.request(`AllergyIntolerance?patient=${e}`).then(a=>{const p=a.entry?.map(y=>y.resource)||[];n(p.length>0?p:[])}).catch(()=>{n([E,L])})}).catch(()=>{n([E,L])})},[e]);function i(t){switch(t){case"active":return"error";case"inactive":return"warning";case"resolved":return"success";default:return"default"}}function c(t){switch(t){case"confirmed":return"primary";case"unconfirmed":return"secondary";case"refuted":return"warning";case"entered-in-error":return"error";default:return"default"}}function s(t){switch(t){case"severe":return"error.main";case"moderate":return"warning.main";case"mild":return"info.main";default:return"text.secondary"}}function d(t){return t?t.extension&&Array.isArray(t.extension)&&t.extension.some(a=>a.url==="http://hl7.org/fhir/StructureDefinition/data-absent-reason"&&a.valueCode==="unknown")?"Unknown":t?hr(t):null:null}return o.jsxs(J,{children:[o.jsx($r,{sx:{mb:0,pb:0},title:o.jsxs(C,{display:"flex",alignItems:"center",gap:1,children:[o.jsx(Tr,{color:"error",fontSize:"medium"}),o.jsx(l,{variant:"h6",fontWeight:600,children:"Allergies & Intolerances"}),o.jsx(yr,{badgeContent:r.length,color:"primary",sx:{ml:2}})]})}),o.jsx(ur,{children:r.length===0?o.jsx(l,{align:"center",color:"text.secondary",sx:{py:4},children:"No information recorded (including no known allergies)."}):r.map(t=>o.jsxs(J,{variant:"outlined",sx:{mb:1,p:2,backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:[o.jsx(C,{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",children:o.jsxs(C,{children:[o.jsxs(C,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",mb:.5,children:[o.jsx(l,{variant:"subtitle1",fontWeight:500,children:t.code?.text||t.code?.coding?.[0].display||`${t.code?.coding?.[0].code} ${t.code?.coding?.[0].system}`||"Unknown Allergy"}),o.jsx(K,{label:t.clinicalStatus?.text||t.clinicalStatus?.coding?.[0]?.code||"Unknown",color:i(t.clinicalStatus?.text||t.clinicalStatus?.coding?.[0]?.code||"Unknown"),variant:"outlined",sx:{textTransform:"capitalize",fontWeight:600}}),o.jsx(K,{label:t.verificationStatus?.text||t.verificationStatus?.coding?.[0]?.code||"Unknown",color:c(t.verificationStatus?.text||t.verificationStatus?.coding?.[0]?.code||"Unknown"),variant:"outlined",sx:{textTransform:"capitalize",fontWeight:600}})]}),o.jsx(l,{variant:"body2",color:"text.secondary",children:`type: ${t.type||"unknown"} - category: ${t.category?.join(", ")||"unknown"}`}),o.jsxs(C,{display:"flex",alignItems:"center",gap:1,mt:1,children:[o.jsx(zr,{fontSize:"small"}),o.jsxs(l,{variant:"body2",color:"text.secondary",children:["Onset:"," ",d(t.onsetDateTime)||"Not recorded"]})]})]})}),t.reaction&&t.reaction.length>0&&o.jsxs(C,{mt:1,children:[o.jsx(l,{variant:"body2",fontWeight:500,color:"text.secondary",children:"Reactions:"}),t.reaction.map((a,p)=>o.jsxs(C,{display:"flex",alignItems:"center",gap:1,ml:2,children:[o.jsxs(l,{variant:"body2",fontWeight:600,sx:{color:s(a.severity||"Unknown"),textTransform:"capitalize"},children:[a.severity,":"]}),o.jsx(l,{variant:"body2",children:a.manifestation.map(y=>y.text).join(", ")})]},p))]})]},t.id))})]})}export{Ar as default};
