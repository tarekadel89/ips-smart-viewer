import{r as P,g as X,a as rr,u as tr,b as C,c as cr,s as j,j as o,d as g,e as er,m as dr,f as pr,T as c,t as K,h as or,i as E,k as L,l as gr,C as G,B as O,n as ur,o as J,p as hr}from"./index-CqL2zBYZ.js";const nr=t=>{const r=P.useRef({});return P.useEffect(()=>{r.current=t}),r.current};function fr(t){const{badgeContent:r,invisible:n=!1,max:a=99,showZero:d=!1}=t,l=nr({badgeContent:r,max:a});let p=n;n===!1&&r===0&&!d&&(p=!0);const{badgeContent:s,max:e=a}=p?l:t,i=s&&Number(s)>e?`${e}+`:s;return{badgeContent:s,invisible:p,max:e,displayValue:i}}function mr(t){return rr("MuiBadge",t)}const y=X("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),V=10,Y=4,vr=t=>{const{color:r,anchorOrigin:n,invisible:a,overlap:d,variant:l,classes:p={}}=t,s={root:["root"],badge:["badge",l,a&&"invisible",`anchorOrigin${g(n.vertical)}${g(n.horizontal)}`,`anchorOrigin${g(n.vertical)}${g(n.horizontal)}${g(d)}`,`overlap${g(d)}`,r!=="default"&&`color${g(r)}`]};return er(s,mr,p)},br=j("span",{name:"MuiBadge",slot:"Root"})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),xr=j("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.badge,r[n.variant],r[`anchorOrigin${g(n.anchorOrigin.vertical)}${g(n.anchorOrigin.horizontal)}${g(n.overlap)}`],n.color!=="default"&&r[`color${g(n.color)}`],n.invisible&&r.invisible]}})(dr(({theme:t})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:V*2,lineHeight:1,padding:"0 6px",height:V*2,borderRadius:V,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.entries(t.palette).filter(pr(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(t.vars||t).palette[r].main,color:(t.vars||t).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:Y,height:Y*2,minWidth:Y*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${y.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]})));function Q(t){return{vertical:t?.vertical??"top",horizontal:t?.horizontal??"right"}}const yr=P.forwardRef(function(r,n){const a=tr({props:r,name:"MuiBadge"}),{anchorOrigin:d,className:l,classes:p,component:s,components:e={},componentsProps:i={},children:m,overlap:v="rectangular",color:S="default",invisible:A=!1,max:B=99,badgeContent:u,slots:h,slotProps:f,showZero:b=!1,variant:R="standard",...M}=a,{badgeContent:x,invisible:k,max:w,displayValue:H}=fr({max:B,invisible:A,badgeContent:u,showZero:b}),I=nr({anchorOrigin:Q(d),color:S,overlap:v,variant:R,badgeContent:u}),T=k||x==null&&R!=="dot",{color:U=S,overlap:N=v,anchorOrigin:W,variant:$=R}=T?I:a,F=Q(W),_=$!=="dot"?H:void 0,D={...a,badgeContent:x,invisible:T,max:w,displayValue:_,showZero:b,anchorOrigin:F,color:U,overlap:N,variant:$},Z=vr(D),q={slots:{root:h?.root??e.Root,badge:h?.badge??e.Badge},slotProps:{root:f?.root??i.root,badge:f?.badge??i.badge}},[ar,ir]=C("root",{elementType:br,externalForwardedProps:{...q,...M},ownerState:D,className:cr(Z.root,l),ref:n,additionalProps:{as:s}}),[sr,lr]=C("badge",{elementType:xr,externalForwardedProps:q,ownerState:D,className:Z.badge});return o.jsxs(ar,{...ir,children:[m,o.jsx(sr,{...lr,children:_})]})});function Cr(t){return rr("MuiCardHeader",t)}const z=X("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Or=t=>{const{classes:r}=t;return er({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Cr,r)},Pr=j("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(t,r)=>[{[`& .${z.title}`]:r.title},{[`& .${z.subheader}`]:r.subheader},r.root]})({display:"flex",alignItems:"center",padding:16}),jr=j("div",{name:"MuiCardHeader",slot:"Avatar"})({display:"flex",flex:"0 0 auto",marginRight:16}),Rr=j("div",{name:"MuiCardHeader",slot:"Action"})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Sr=j("div",{name:"MuiCardHeader",slot:"Content"})({flex:"1 1 auto",[`.${K.root}:where(& .${z.title})`]:{display:"block"},[`.${K.root}:where(& .${z.subheader})`]:{display:"block"}}),Tr=P.forwardRef(function(r,n){const a=tr({props:r,name:"MuiCardHeader"}),{action:d,avatar:l,component:p="div",disableTypography:s=!1,subheader:e,subheaderTypographyProps:i,title:m,titleTypographyProps:v,slots:S={},slotProps:A={},...B}=a,u={...a,component:p,disableTypography:s},h=Or(u),f={slots:S,slotProps:{title:v,subheader:i,...A}};let b=m;const[R,M]=C("title",{className:h.title,elementType:c,externalForwardedProps:f,ownerState:u,additionalProps:{variant:l?"body2":"h5",component:"span"}});b!=null&&b.type!==c&&!s&&(b=o.jsx(R,{...M,children:b}));let x=e;const[k,w]=C("subheader",{className:h.subheader,elementType:c,externalForwardedProps:f,ownerState:u,additionalProps:{variant:l?"body2":"body1",color:"textSecondary",component:"span"}});x!=null&&x.type!==c&&!s&&(x=o.jsx(k,{...w,children:x}));const[H,I]=C("root",{ref:n,className:h.root,elementType:Pr,externalForwardedProps:{...f,...B,component:p},ownerState:u}),[T,U]=C("avatar",{className:h.avatar,elementType:jr,externalForwardedProps:f,ownerState:u}),[N,W]=C("content",{className:h.content,elementType:Sr,externalForwardedProps:f,ownerState:u}),[$,F]=C("action",{className:h.action,elementType:Rr,externalForwardedProps:f,ownerState:u});return o.jsxs(H,{...I,children:[l&&o.jsx(T,{...U,children:l}),o.jsxs(N,{...W,children:[b,x]}),d&&o.jsx($,{...F,children:d})]})}),$r=or([o.jsx("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22z"},"0"),o.jsx("path",{d:"M13 16h-2v2h2zm0-6h-2v5h2z"},"1")]),zr=or([o.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),o.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]);function Br({patientId:t}){const r="patient-example-female",[n,a]=P.useState([]);P.useEffect(()=>{if(t===r){a([E,L]);return}gr.oauth2.ready().then(e=>{console.log("Fetching allergies for patient:",t),console.log("Using client:",e),e.request("AllergyIntolerance?patient=Patient/"+t).then(i=>{console.log("Received bundle:",i);const m=i.entry?.map(v=>v.resource)||[];a(m.length>0?m:[])}).catch(()=>{console.log("Failed to fetch allergies for patient:",t),a([E,L])})}).catch(()=>{console.log("No SMART context, using mock data",t),a([E,L])})},[t]);function d(e){switch(e){case"active":return"error";case"inactive":return"warning";case"resolved":return"success";default:return"default"}}function l(e){switch(e){case"confirmed":return"primary";case"unconfirmed":return"secondary";case"refuted":return"warning";case"entered-in-error":return"error";default:return"default"}}function p(e){switch(e){case"severe":return"error.main";case"moderate":return"warning.main";case"mild":return"info.main";default:return"text.secondary"}}function s(e){return e?e.extension&&Array.isArray(e.extension)&&e.extension.some(i=>i.url==="http://hl7.org/fhir/StructureDefinition/data-absent-reason"&&i.valueCode==="unknown")?"Unknown":e?hr(e):null:null}return o.jsxs(G,{children:[o.jsx(Tr,{sx:{mb:0,pb:0},title:o.jsxs(O,{display:"flex",alignItems:"center",gap:1,children:[o.jsx($r,{color:"error",fontSize:"medium"}),o.jsx(c,{variant:"h6",fontWeight:600,children:"Allergies & Intolerances"}),o.jsx(yr,{badgeContent:n.length,color:"primary",sx:{ml:2}})]})}),o.jsx(ur,{children:n.length===0?o.jsx(c,{align:"center",color:"text.secondary",sx:{py:4},children:"No information recorded (including no known allergies)."}):n.map(e=>o.jsxs(G,{variant:"outlined",sx:{mb:1,p:2,backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:[o.jsx(O,{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",children:o.jsxs(O,{children:[o.jsxs(O,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",mb:.5,children:[o.jsx(c,{variant:"subtitle1",fontWeight:500,children:e.code?.text||e.code?.coding?.[0].display||`${e.code?.coding?.[0].code} ${e.code?.coding?.[0].system}`||"Unknown Allergy"}),o.jsx(J,{label:e.clinicalStatus?.text||e.clinicalStatus?.coding?.[0]?.code||"Unknown",color:d(e.clinicalStatus?.coding?.[0]?.code||"Unknown"),variant:"outlined",sx:{textTransform:"capitalize",fontWeight:600}}),o.jsx(J,{label:e.verificationStatus?.text||e.verificationStatus?.coding?.[0]?.code||"Unknown",color:l(e.verificationStatus?.coding?.[0]?.code||"Unknown"),variant:"outlined",sx:{textTransform:"capitalize",fontWeight:600}})]}),o.jsx(c,{variant:"body2",color:"text.secondary",children:`type: ${e.type||"unknown"} - category: ${e.category?.join(", ")||"unknown"}`}),o.jsxs(O,{display:"flex",alignItems:"center",gap:1,mt:1,children:[o.jsx(zr,{fontSize:"small"}),o.jsxs(c,{variant:"body2",color:"text.secondary",children:["Onset:"," ",s(e.onsetDateTime)||"Not recorded"]})]})]})}),e.reaction&&e.reaction.length>0&&o.jsxs(O,{mt:1,children:[o.jsx(c,{variant:"body2",fontWeight:500,color:"text.secondary",children:"Reactions:"}),e.reaction.map((i,m)=>o.jsxs(O,{display:"flex",alignItems:"center",gap:1,ml:2,children:[o.jsxs(c,{variant:"body2",fontWeight:600,sx:{color:p(i.severity||"Unknown"),textTransform:"capitalize"},children:[i.severity,":"]}),o.jsx(c,{variant:"body2",children:i.manifestation.map(v=>v.text).join(", ")})]},m))]})]},e.id))})]})}export{Br as default};
